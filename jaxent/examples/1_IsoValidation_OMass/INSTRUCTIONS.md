
This example provides methods to download the datasets directly from the Zenodo link from Bradshaw et al. The zip folder is ~13GB

Alternatively, trimmed ValDXer trajectories can be found in:
https://drive.google.com/drive/folders/1Y9294af-SLca80Xk4D2gmg460NXlt7wX?usp=sharing

Within the latest directory, this example requires the _Bradshaw directory - place this in the data/ dir.

total example dir ~1GB, required _Bradshaw folder within ~275MB

### All paths are relative to the scripts themselves - you are intended to run the scripts from the main repo dir: JAX-ENT/

# Instructions

[Optional]: Download the '_Bradshaw' folder from the latest 'ValDXer_500' directory in the google drive link above into the 'data' folder.

1. Run: data/get_HDXer_AutoValidation_data.py [slicing_interval]
- This will download the files from the original zenodo link, this will slice the trajectories to generate those from the google drive link. Create the bi-modal trajectory through simple RMSD assignment of the sliced, combined trajectory (TeaA_initial_sliced.xtc)

Note: If not downloaded from the google drive link, this should take ~30 mins (13 GB) depending on your connection

2. Run: data/extract_synthetic_data.py
- This extracts the original intrinsic rates generated by HDXer.

[Optional]: Run: analysis/plot_intrinsic_rates_simple.py 
- This will generate plots showing the alignment of the intrinsic rates

3. Run: fitting/jaxENT/featurise_ISO_TRI_BI.py
- This will featurise both trajectories and overwrites the intrinsic rates with those obtained by HDXer.

Note: Expected run time ~3-5 minutes

4. Run: fitting/jaxENT/splitdata_ISO.py
- This will run the splitting pipeline over: Random, Sequence, Spatial, Sequence cluster, and Stratified splits

[Optional]: Run: analysis/analyse_split_ISO_TRI_BI.py 
- This will generate plots of each split type created in splitdata_ISO.py

5. Run: fitting/jaxENT/optimise_ISO_TRI_BI_splits.py 
- This will run the optimisation loop over convergence thresholds : 10e-3 - 10e-10 for both bi-modal and tri-modal ensembles over all split types (5) and replicates (3)

Note: Expected run time ~40-50 minutes. This can be reduced by lowering n_steps and n_replicates or reducing the split_types run for using the script arguments for optimise_ISO_TRI_BI_splits.py. Setting:
```python
python fitting/jaxENT/optimise_ISO_TRI_BI_splits.py --split-types random, sequence_cluster, spatial --n-steps 1000  --n-replicates 3
```
This should take ~15-20 minutes.

[Optional]: Run: analysis/analyse_loss_ISO_TRI_BI.py 
- This will generate plots of the training and validation losses across split types

6. Run: analysis/ratio_recovery_ISO_TRI_BI.py
- This will run analysis of the weights across convergence thresholds and plot the open state recovery% as well the KL divergence (Work Done) across split types and replicates.